name: Build Components

on:
  push:
    branches:
      - development
  pull_request:
    branches:
      - development

jobs:
  set-matrix:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        event: ["push", "pull_request"]

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Set Matrix and Build
        id: set-matrix
        uses: ./.github/actions/test_matrix
        with:
          event: ${{ matrix.event }}

  use-matrix:
    needs: set-matrix
    runs-on: ubuntu-latest
    strategy:
      matrix: ${{fromJson(needs.set-matrix.outputs.matrix)}}
    steps:
      - name: Use matrix
        run: |
          matrix="${{ matrix }}"
          paths="${{ matrix.paths }}"
          docker_files="${{ matrix.docker_files }}"
          working_dirs="${{ matrix.working_dirs }}"
          image_names="${{ matrix.image_names }}"
  
          echo "Component: $matrix"
          echo "Paths: $paths"
          echo "Dockerfile: $docker_files"
          echo "Working Directory: $working_dirs"
          echo "Image Name: $image_names"
  